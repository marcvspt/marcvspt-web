---
import NavLink from "@/components/NavLink.astro";

import DropdownIcon from "@/icons/DropdownIcon.astro";

import { NAV_ITEMS, BLOG_ITEMS } from "@/scripts/data";
---

<nav class="py-8 px-4">
    <ul class="space-y-2 w-full">
        {
            NAV_ITEMS.map((navItem) => (
                <NavLink linkUrl={navItem.url}>{navItem.title}</NavLink>
            ))
        }
        <li class="py-2">
            <button
                id="submenu-dropdown-btn"
                class="flex flex-row justify-between w-full hover:font-semibold"
            >
                Blog
                <DropdownIcon id="submenu-dropdown-icon" />
            </button>
            <ul id="submenu" class="py-2 hidden">
                {
                    BLOG_ITEMS.map((blogItem) => (
                        <NavLink className="px-4" linkUrl={blogItem.url}>
                            {blogItem.title}
                        </NavLink>
                    ))
                }
            </ul>
        </li>
    </ul>
</nav>
<script is:inline>
    function initializeDropdown() {
        const $dropdownButton = document.querySelector("#submenu-dropdown-btn");
        const $subMenu = document.querySelector("#submenu");
        const $dropdownIcon = document.querySelector("#submenu-dropdown-icon");

        if ($dropdownButton && $subMenu && $dropdownIcon) {
            $dropdownButton.addEventListener("click", (e) => {
                e.stopPropagation();
                $subMenu.classList.toggle("hidden");
                $dropdownIcon.classList.toggle("rotate-180");
            });
        }
    }

    initializeDropdown();

    document.addEventListener("astro:after-swap", () => {
        initializeDropdown();
    });
</script>
